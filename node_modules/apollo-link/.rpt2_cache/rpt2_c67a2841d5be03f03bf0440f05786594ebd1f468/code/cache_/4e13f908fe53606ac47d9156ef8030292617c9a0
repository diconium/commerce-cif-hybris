{"code":"import * as tslib_1 from \"tslib\";\r\nimport Observable from 'zen-observable-ts';\r\nimport { print } from 'graphql/language/printer';\r\nexport function getOperationName(doc) {\r\n    return (doc.definitions\r\n        .filter(function (definition) {\r\n        return definition.kind === 'OperationDefinition' && definition.name;\r\n    })\r\n        .map(function (x) { return x.name.value; })[0] || null);\r\n}\r\nexport function validateOperation(operation) {\r\n    var OPERATION_FIELDS = [\r\n        'query',\r\n        'operationName',\r\n        'variables',\r\n        'extensions',\r\n        'context',\r\n    ];\r\n    for (var _i = 0, _a = Object.keys(operation); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        if (OPERATION_FIELDS.indexOf(key) < 0) {\r\n            throw new Error(\"illegal argument: \" + key);\r\n        }\r\n    }\r\n    return operation;\r\n}\r\nvar LinkError = (function (_super) {\r\n    tslib_1.__extends(LinkError, _super);\r\n    function LinkError(message, link) {\r\n        var _this = _super.call(this, message) || this;\r\n        _this.link = link;\r\n        return _this;\r\n    }\r\n    return LinkError;\r\n}(Error));\r\nexport { LinkError };\r\nexport function isTerminating(link) {\r\n    return link.request.length <= 1;\r\n}\r\nexport function toPromise(observable) {\r\n    var completed = false;\r\n    return new Promise(function (resolve, reject) {\r\n        observable.subscribe({\r\n            next: function (data) {\r\n                if (completed) {\r\n                    console.warn(\"Promise Wrapper does not support multiple results from Observable\");\r\n                }\r\n                else {\r\n                    completed = true;\r\n                    resolve(data);\r\n                }\r\n            },\r\n            error: reject,\r\n        });\r\n    });\r\n}\r\nexport var makePromise = toPromise;\r\nexport function fromPromise(promise) {\r\n    return new Observable(function (observer) {\r\n        promise\r\n            .then(function (value) {\r\n            observer.next(value);\r\n            observer.complete();\r\n        })\r\n            .catch(observer.error.bind(observer));\r\n    });\r\n}\r\nexport function fromError(errorValue) {\r\n    return new Observable(function (observer) {\r\n        observer.error(errorValue);\r\n    });\r\n}\r\nexport function transformOperation(operation) {\r\n    var transformedOperation = {\r\n        variables: operation.variables || {},\r\n        extensions: operation.extensions || {},\r\n        operationName: operation.operationName,\r\n        query: operation.query,\r\n    };\r\n    if (!transformedOperation.operationName) {\r\n        transformedOperation.operationName =\r\n            typeof transformedOperation.query !== 'string'\r\n                ? getOperationName(transformedOperation.query)\r\n                : '';\r\n    }\r\n    return transformedOperation;\r\n}\r\nexport function createOperation(starting, operation) {\r\n    var context = tslib_1.__assign({}, starting);\r\n    var setContext = function (next) {\r\n        if (typeof next === 'function') {\r\n            context = tslib_1.__assign({}, context, next(context));\r\n        }\r\n        else {\r\n            context = tslib_1.__assign({}, context, next);\r\n        }\r\n    };\r\n    var getContext = function () { return (tslib_1.__assign({}, context)); };\r\n    Object.defineProperty(operation, 'setContext', {\r\n        enumerable: false,\r\n        value: setContext,\r\n    });\r\n    Object.defineProperty(operation, 'getContext', {\r\n        enumerable: false,\r\n        value: getContext,\r\n    });\r\n    Object.defineProperty(operation, 'toKey', {\r\n        enumerable: false,\r\n        value: function () { return getKey(operation); },\r\n    });\r\n    return operation;\r\n}\r\nexport function getKey(operation) {\r\n    return print(operation.query) + \"|\" + JSON.stringify(operation.variables) + \"|\" + operation.operationName;\r\n}\r\n//# sourceMappingURL=linkUtils.js.map","map":"{\"version\":3,\"file\":\"linkUtils.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/linkUtils.ts\"],\"names\":[],\"mappings\":\"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\"}","dtsmap":{"name":"/Users/hwillson/Documents/git/apollo/apollo-link/packages/apollo-link/linkUtils.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"linkUtils.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"src/linkUtils.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,UAAU,MAAM,mBAAmB,CAAC;AAE3C,OAAO,EAAE,YAAY,EAA2B,MAAM,SAAS,CAAC;AAEhE,OAAO,EAAE,cAAc,EAAE,SAAS,EAAE,MAAM,SAAS,CAAC;AACpD,OAAO,EAAE,UAAU,EAAE,MAAM,QAAQ,CAAC;AAEpC,wBAAgB,gBAAgB,CAAC,GAAG,EAAE,YAAY,GAAG,MAAM,GAAG,IAAI,CASjE;AAED,wBAAgB,iBAAiB,CAAC,SAAS,EAAE,cAAc,GAAG,cAAc,CAe3E;AAED,qBAAa,SAAU,SAAQ,KAAK;IAC3B,IAAI,EAAE,UAAU,CAAC;gBACZ,OAAO,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,UAAU;CAIhD;AAED,wBAAgB,aAAa,CAAC,IAAI,EAAE,UAAU,GAAG,OAAO,CAEvD;AAED,wBAAgB,SAAS,CAAC,CAAC,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAiBlE;AAGD,eAAO,MAAM,WAAW,kBAAY,CAAC;AAErC,wBAAgB,WAAW,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CASjE;AAED,wBAAgB,SAAS,CAAC,CAAC,EAAE,UAAU,EAAE,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC,CAI3D;AAED,wBAAgB,kBAAkB,CAAC,SAAS,EAAE,cAAc,GAAG,cAAc,CAiB5E;AAED,wBAAgB,eAAe,CAC7B,QAAQ,EAAE,GAAG,EACb,SAAS,EAAE,cAAc,GACxB,SAAS,CA2BX;AAED,wBAAgB,MAAM,CAAC,SAAS,EAAE,cAAc,UAM/C\"}"},"dts":{"name":"/Users/hwillson/Documents/git/apollo/apollo-link/packages/apollo-link/linkUtils.d.ts","writeByteOrderMark":false,"text":"import Observable from 'zen-observable-ts';\r\nimport { DocumentNode } from 'graphql';\r\nimport { GraphQLRequest, Operation } from './types';\r\nimport { ApolloLink } from './link';\r\nexport declare function getOperationName(doc: DocumentNode): string | null;\r\nexport declare function validateOperation(operation: GraphQLRequest): GraphQLRequest;\r\nexport declare class LinkError extends Error {\r\n    link: ApolloLink;\r\n    constructor(message?: string, link?: ApolloLink);\r\n}\r\nexport declare function isTerminating(link: ApolloLink): boolean;\r\nexport declare function toPromise<R>(observable: Observable<R>): Promise<R>;\r\nexport declare const makePromise: typeof toPromise;\r\nexport declare function fromPromise<T>(promise: Promise<T>): Observable<T>;\r\nexport declare function fromError<T>(errorValue: any): Observable<T>;\r\nexport declare function transformOperation(operation: GraphQLRequest): GraphQLRequest;\r\nexport declare function createOperation(starting: any, operation: GraphQLRequest): Operation;\r\nexport declare function getKey(operation: GraphQLRequest): string;\r\n//# sourceMappingURL=linkUtils.d.ts.map"}}
